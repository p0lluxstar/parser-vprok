# parser-vprok

Парсер для сайта vprok.ru, который извлекает информацию о товарах с помощью Puppeteer.

## Описание

Проект предоставляет два типа парсеров:

1. **Парсер отдельного товара** (`puppeteer.ts`) - извлекает данные о конкретном товаре (цена, старая цена, рейтинг, количество отзывов) и создаёт скриншот страницы
2. **Парсер списка товаров** (`api-parser.ts`) - извлекает данные о всех товарах со страницы категории/каталога из JSON данных **NEXT_DATA**

## Технологии

- **TypeScript** - основной язык разработки
- **Puppeteer** - автоматизация браузера для парсинга
- **puppeteer-extra** и **puppeteer-extra-plugin-stealth** - обход детекции автоматизации
- **Node.js** - среда выполнения

## Установка

1. Клонируйте репозиторий или скачайте проект

2. Установите зависимости:

```bash
npm install
```

3. Соберите проект:

```bash
npm run build
```

## Использование

### Парсер отдельного товара

Парсит данные о конкретном товаре и сохраняет их в `parsed/product.txt`, а также создаёт скриншот в `parsed/screenshot.jpg`.

**Синтаксис:**

```bash
npm run puppeteer <URL> <REGION>
```

**Параметры:**

- `URL` - ссылка на страницу товара на vprok.ru
- `REGION` - название региона (например, "Москва")

**Пример:**

```bash
npm run puppeteer "https://www.vprok.ru/product/123456" "Москва"
```

**Результат:**

- `parsed/product.txt` - файл с данными о товаре (цена, старая цена, рейтинг, количество отзывов)
- `parsed/screenshot.jpg` - скриншот страницы товара

### Парсер списка товаров

Парсит все товары со страницы категории/каталога и сохраняет их в `parsed/products-api.txt`.

**Синтаксис:**

```bash
npm run api <URL>
```

**Параметры:**

- `URL` - ссылка на страницу категории/каталога на vprok.ru

**Пример:**

```bash
npm run api "https://www.vprok.ru/catalog/123/molochnye-produkty"
```

**Результат:**

- `parsed/products-api.txt` - файл с данными о всех товарах со страницы

## Структура проекта

```
parser-vprok/
├── src/
│   ├── puppeteer.ts      # Парсер отдельного товара
│   ├── api-parser.ts     # Парсер списка товаров
│   └── interface.ts      # Интерфейсы TypeScript
├── parsed/               # Директория для результатов парсинга
│   ├── product.txt       # Результаты парсинга отдельного товара
│   ├── products-api.txt  # Результаты парсинга списка товаров
│   └── screenshot.jpg    # Скриншот страницы товара
├── package.json
├── tsconfig.json
└── README.md
```

## Интерфейсы

### IProduct

Интерфейс для описания товара:

```typescript
interface IProduct {
    productId: number;
    name: string;
    url: string;
    price: number;
    oldPrice: number;
    discount: number;
    rating: number;
    reviews: number;
}
```

## Скрипты

- `npm run build` - компиляция TypeScript в JavaScript
- `npm run puppeteer` - запуск парсера отдельного товара
- `npm run api` - запуск парсера списка товаров
- `npm run lint` - проверка кода линтером

## Особенности

- Использует stealth-плагин для обхода детекции автоматизации
- Поддерживает выбор региона для корректного отображения цен
- Извлекает данные как из DOM-элементов, так и из JSON данных страницы
- Автоматически создаёт скриншоты страниц
- Результаты сохраняются в текстовые файлы в директории `parsed/`

## Требования

- Node.js (версия 18+)
- npm или yarn

## Лицензия

ISC
